<?php

namespace Tests\Unit;

use PHPUnit\Framework\Attributes\DataProvider;
use Tests\TestCase;
use UkrainianDeclension\Enums\GrammaticalCase;
use UkrainianDeclension\Enums\Number;
use UkrainianDeclension\UkrainianDeclension;

class MilitaryRankTest extends TestCase
{
    #[DataProvider('militaryRankNames')]
    public function testMilitaryRankNames(string $name, GrammaticalCase $case, string $expected): void
    {
        $result = UkrainianDeclension::decline($name, $case, Number::SINGULAR);
        $this->assertEquals($expected, $result);
    }

    public static function militaryRankNames(): \Generator
    {
        $names = [
            'підполковник СУЧКОВ Ярослав Олександрович' => [
                'genitive' => 'підполковника СУЧКОВА Ярослава Олександровича',
                'dative' => 'підполковнику СУЧКОВУ Ярославу Олександровичу',
                'accusative' => 'підполковника СУЧКОВА Ярослава Олександровича',
                'instrumental' => 'підполковником СУЧКОВИМ Ярославом Олександровичем',
                'locative' => 'підполковникові СУЧКОВІ Ярославові Олександровичу',
                'vocative' => 'підполковнику СУЧКОВЕ Ярославе Олександровичу',
            ],
            'капітан ПЕТРЕНКО Костянтин Іванович' => [
                'genitive' => 'капітана ПЕТРЕНКА Костянтина Івановича',
                'dative' => 'капітану ПЕТРЕНКУ Костянтину Івановичу',
                'accusative' => 'капітана ПЕТРЕНКА Костянтина Івановича',
                'instrumental' => 'капітаном ПЕТРЕНКОМ Костянтином Івановичем',
                'locative' => 'капітанові ПЕТРЕНКОВІ Костянтинові Івановичу',
                'vocative' => 'капітане ПЕТРЕНКУ Костянтине Івановичу',
            ],
            'майор КОВАЛЕНКО Андрій Петрович' => [
                'genitive' => 'майора КОВАЛЕНКА Андрія Петровича',
                'dative' => 'майору КОВАЛЕНКУ Андрію Петровичу',
                'accusative' => 'майора КОВАЛЕНКА Андрія Петровича',
                'instrumental' => 'майором КОВАЛЕНКОМ Андрієм Петровичем',
                'locative' => 'майорові КОВАЛЕНКОВІ Андрієві Петровичу',
                'vocative' => 'майоре КОВАЛЕНКУ Андрію Петровичу',
            ],
            'старший лейтенант ДЖУРЯК Роман Михайлович' => [
                'genitive' => 'старшого лейтенанта ДЖУРЯКА Романа Михайловича',
                'dative' => 'старшому лейтенанту ДЖУРЯКУ Роману Михайловичу',
                'accusative' => 'старшого лейтенанта ДЖУРЯКА Романа Михайловича',
                'instrumental' => 'старшим лейтенантом ДЖУРЯКОМ Романом Михайловичем',
                'locative' => 'старшому лейтенантові ДЖУРЯКОВІ Романові Михайловичу',
                'vocative' => 'старший лейтенанте ДЖУРЯКУ Романе Михайловичу',
            ],
            'старший лейтенант СЛАБКИЙ Віктор Юрійович' => [
                'genitive' => 'старшого лейтенанта СЛАБКОГО Віктора Юрійовича',
                'dative' => 'старшому лейтенанту СЛАБКОМУ Віктору Юрійовичу',
                'accusative' => 'старшого лейтенанта СЛАБКОГО Віктора Юрійовича',
                'instrumental' => 'старшим лейтенантом СЛАБКИМ Віктором Юрійовичем',
                'locative' => 'старшому лейтенантові СЛАБКОМУ Вікторові Юрійовичу',
                'vocative' => 'старший лейтенанте СЛАБКИЙ Вікторе Юрійовичу',
            ],
            'старший солдат СМОЛЯРОВ Дмитро Юрійович' => [
                'genitive' => 'старшого солдата СМОЛЯРОВА Дмитра Юрійовича',
                'dative' => 'старшому солдату СМОЛЯРОВУ Дмитру Юрійовичу',
                'accusative' => 'старшого солдата СМОЛЯРОВА Дмитра Юрійовича',
                'instrumental' => 'старшим солдатом СМОЛЯРОВИМ Дмитром Юрійовичем',
                'locative' => 'старшому солдатові СМОЛЯРОВІ Дмитрові Юрійовичу',
                'vocative' => 'старший солдате СМОЛЯРОВЕ Дмитре Юрійовичу',
            ],
            'старший лейтенант ВАСИЛЕНКО Олена Олександрівна' => [
                'genitive' => 'старшого лейтенанта ВАСИЛЕНКО Олени Олександрівни',
                'dative' => 'старшому лейтенанту ВАСИЛЕНКО Олені Олександрівні',
                'accusative' => 'старшого лейтенанта ВАСИЛЕНКО Олену Олександрівну',
                'instrumental' => 'старшим лейтенантом ВАСИЛЕНКО Оленою Олександрівною',
                'locative' => 'старшому лейтенантові ВАСИЛЕНКО Олені Олександрівні',
                'vocative' => 'старший лейтенанте ВАСИЛЕНКО Олено Олександрівно',
            ],
            'молодший сержант КНЯЗЬ Максим Святославович' => [
                'genitive' => 'молодшого сержанта КНЯЗЯ Максима Святославовича',
                'dative' => 'молодшому сержанту КНЯЗЮ Максиму Святославовичу',
                'accusative' => 'молодшого сержанта КНЯЗЯ Максима Святославовича',
                'instrumental' => 'молодшим сержантом КНЯЗЕМ Максимом Святославовичем',
                'locative' => 'молодшому сержантові КНЯЗЕВІ Максимові Святославовичу',
                'vocative' => 'молодший сержанте КНЯЗЮ Максиме Святославовичу',
            ],
            'старший лейтенант ОРЖЕШКО Катерина Георгіївна' => [
                'genitive' => 'старшого лейтенанта ОРЖЕШКО Катерини Георгіївни',
                'dative' => 'старшому лейтенанту ОРЖЕШКО Катерині Георгіївні',
                'accusative' => 'старшого лейтенанта ОРЖЕШКО Катерину Георгіївну',
                'instrumental' => 'старшим лейтенантом ОРЖЕШКО Катериною Георгіївною',
                'locative' => 'старшому лейтенантові ОРЖЕШКО Катерині Георгіївні',
                'vocative' => 'старший лейтенанте ОРЖЕШКО Катерино Георгіївно',
            ],
            'молодший сержант КАРТАВА Анна Олексіївна' => [
                'genitive' => 'молодшого сержанта КАРТАВОЇ Анни Олексіївни',
                'dative' => 'молодшому сержанту КАРТАВІЙ Анні Олексіївні',
                'accusative' => 'молодшого сержанта КАРТАВУ Анну Олексіївну',
                'instrumental' => 'молодшим сержантом КАРТАВОЮ Анною Олексіївною',
                'locative' => 'молодшому сержантові КАРТАВІЙ Анні Олексіївні',
                'vocative' => 'молодший сержанте КАРТАВА Анно Олексіївно',
            ],
            'старший солдат КРАВЕЦЬ Ярослав Васильович' => [
                'genitive' => 'старшого солдата КРАВЦЯ Ярослава Васильовича',
                'dative' => 'старшому солдату КРАВЦЮ Ярославу Васильовичу',
                'accusative' => 'старшого солдата КРАВЦЯ Ярослава Васильовича',
                'instrumental' => 'старшим солдатом КРАВЦЕМ Ярославом Васильовичем',
                'locative' => 'старшому солдатові КРАВЦЕВІ Ярославові Васильовичу',
                'vocative' => 'старший солдате КРАВЦЮ Ярославе Васильовичу',
            ],
            'молодший сержант ПАНЬКО Тарас Вікторович' => [
                'genitive' => 'молодшого сержанта ПАНЬКА Тараса Вікторовича',
                'dative' => 'молодшому сержанту ПАНЬКУ Тарасу Вікторовичу',
                'accusative' => 'молодшого сержанта ПАНЬКА Тараса Вікторовича',
                'instrumental' => 'молодшим сержантом ПАНЬКОМ Тарасом Вікторовичем',
                'locative' => 'молодшому сержантові ПАНЬКОВІ Тарасові Вікторовичу',
                'vocative' => 'молодший сержанте ПАНЬКУ Тарасе Вікторовичу',
            ],
            'молодший сержант СОЛОМАХА Богдан Георгійович' => [
                'genitive' => 'молодшого сержанта СОЛОМАХИ Богдана Георгійовича',
                'dative' => 'молодшому сержанту СОЛОМАСІ Богдану Георгійовичу',
                'accusative' => 'молодшого сержанта СОЛОМАХУ Богдана Георгійовича',
                'instrumental' => 'молодшим сержантом СОЛОМАХОЮ Богданом Георгійовичем',
                'locative' => 'молодшому сержантові СОЛОМАСІ Богданові Георгійовичу',
                'vocative' => 'молодший сержанте СОЛОМАХО Богдане Георгійовичу',
            ],
            'молодший сержант БАБІЙ Артем Іванович' => [
                'genitive' => 'молодшого сержанта БАБІЯ Артема Івановича',
                'dative' => 'молодшому сержанту БАБІЮ Артему Івановичу',
                'accusative' => 'молодшого сержанта БАБІЯ Артема Івановича',
                'instrumental' => 'молодшим сержантом БАБІЄМ Артемом Івановичем',
                'locative' => 'молодшому сержантові БАБІЄВІ Артемові Івановичу',
                'vocative' => 'молодший сержанте БАБІЮ Артеме Івановичу',
            ],
            'старший сержант ГРЕЧКА Павло Дмитрович' => [
                'genitive' => 'старшого сержанта ГРЕЧКИ Павла Дмитровича',
                'dative' => 'старшому сержанту ГРЕЧЦІ Павлу Дмитровичу',
                'accusative' => 'старшого сержанта ГРЕЧКУ Павла Дмитровича',
                'instrumental' => 'старшим сержантом ГРЕЧКОЮ Павлом Дмитровичем',
                'locative' => 'старшому сержантові ГРЕЧЦІ Павлові Дмитровичу',
                'vocative' => 'старший сержанте ГРЕЧКО Павле Дмитровичу',
            ],
        ];

        foreach ($names as $name => $cases) {
            yield "{$name} (nominative)" => [$name, GrammaticalCase::NOMINATIVE, $name];
            foreach ($cases as $case => $expected) {
                yield "{$name} ({$case})" => [$name, GrammaticalCase::from($case), $expected];
            }
        }
    }
} 