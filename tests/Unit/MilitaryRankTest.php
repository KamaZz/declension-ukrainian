<?php

namespace Tests\Unit;

use PHPUnit\Framework\Attributes\DataProvider;
use Tests\TestCase;
use UkrainianDeclension\Enums\GrammaticalCase;
use UkrainianDeclension\Enums\Number;
use UkrainianDeclension\UkrainianDeclension;

class MilitaryRankTest extends TestCase
{
    #[DataProvider('militaryRankNames')]
    public function testMilitaryRankNames(string $name, GrammaticalCase $case, string $expected): void
    {
        $result = UkrainianDeclension::decline($name, $case, Number::SINGULAR);
        $this->assertEquals($expected, $result);
    }

    public static function militaryRankNames(): \Generator
    {
        $names = [
            'підполковник СУЧКОВ Віталій Олександрович' => [
                'genitive' => 'підполковника СУЧКОВА Віталія Олександровича',
                'dative' => 'підполковнику СУЧКОВУ Віталію Олександровичу',
                'accusative' => 'підполковника СУЧКОВА Віталія Олександровича',
                'instrumental' => 'підполковником СУЧКОВИМ Віталієм Олександровичем',
                'locative' => 'підполковнику СУЧКОВІ Віталієві Олександровичу',
                'vocative' => 'підполковнику СУЧКОВЕ Віталію Олександровичу',
            ],
            'капітан ПЕТРЕНКО Олександр Іванович' => [
                'genitive' => 'капітана ПЕТРЕНКА Олександра Івановича',
                'dative' => 'капітану ПЕТРЕНКУ Олександру Івановичу',
                'accusative' => 'капітана ПЕТРЕНКА Олександра Івановича',
                'instrumental' => 'капітаном ПЕТРЕНКОМ Олександром Івановичем',
                'locative' => 'капітану ПЕТРЕНКОВІ Олександрові Івановичу',
                'vocative' => 'капітане ПЕТРЕНКУ Олександре Івановичу',
            ],
            'майор КОВАЛЕНКО Сергій Петрович' => [
                'genitive' => 'майора КОВАЛЕНКА Сергія Петровича',
                'dative' => 'майору КОВАЛЕНКУ Сергію Петровичу',
                'accusative' => 'майора КОВАЛЕНКА Сергія Петровича',
                'instrumental' => 'майором КОВАЛЕНКОМ Сергієм Петровичем',
                'locative' => 'майору КОВАЛЕНКОВІ Сергієві Петровичу',
                'vocative' => 'майоре КОВАЛЕНКУ Сергію Петровичу',
            ],
            'старший лейтенант ДЖУРЯК Іван Михайлович' => [
                'genitive' => 'старшого лейтенанта ДЖУРЯКА Івана Михайловича',
                'dative' => 'старшому лейтенанту ДЖУРЯКУ Івану Михайловичу',
                'accusative' => 'старшого лейтенанта ДЖУРЯКА Івана Михайловича',
                'instrumental' => 'старшим лейтенантом ДЖУРЯКОМ Іваном Михайловичем',
                'locative' => 'старшому лейтенанту ДЖУРЯКОВІ Іванові Михайловичу',
                'vocative' => 'старший лейтенанте ДЖУРЯКУ Іване Михайловичу',
            ],
            'старший лейтенант СЛАБКИЙ Руслан Юрійович' => [
                'genitive' => 'старшого лейтенанта СЛАБКОГО Руслана Юрійовича',
                'dative' => 'старшому лейтенанту СЛАБКОМУ Руслану Юрійовичу',
                'accusative' => 'старшого лейтенанта СЛАБКОГО Руслана Юрійовича',
                'instrumental' => 'старшим лейтенантом СЛАБКИМ Русланом Юрійовичем',
                'locative' => 'старшому лейтенанту СЛАБКОМУ Руслану Юрійовичу',
                'vocative' => 'старший лейтенанте СЛАБКИЙ Руслане Юрійовичу',
            ],
            'старший солдат СМОЛЯРОВ Олександр Юрійович' => [
                'genitive' => 'старшого солдата СМОЛЯРОВА Олександра Юрійовича',
                'dative' => 'старшому солдату СМОЛЯРОВУ Олександру Юрійовичу',
                'accusative' => 'старшого солдата СМОЛЯРОВА Олександра Юрійовича',
                'instrumental' => 'старшим солдатом СМОЛЯРОВИМ Олександром Юрійовичем',
                'locative' => 'старшому солдату СМОЛЯРОВІ Олександрові Юрійовичу',
                'vocative' => 'старший солдате СМОЛЯРОВЕ Олександре Юрійовичу',
            ],
            'старший лейтенант ВАСИЛЕНКО Марія Олександрівна' => [
                'genitive' => 'старшого лейтенанта ВАСИЛЕНКО Марії Олександрівни',
                'dative' => 'старшому лейтенанту ВАСИЛЕНКО Марії Олександрівні',
                'accusative' => 'старшого лейтенанта ВАСИЛЕНКО Марію Олександрівну',
                'instrumental' => 'старшим лейтенантом ВАСИЛЕНКО Марією Олександрівною',
                'locative' => 'старшому лейтенанту ВАСИЛЕНКО Марії Олександрівні',
                'vocative' => 'старший лейтенанте ВАСИЛЕНКО Маріє Олександрівно',
            ],
            'молодший сержант КНЯЗЬ Сергій Святославович' => [
                'genitive' => 'молодшого сержанта КНЯЗЯ Сергія Святославовича',
                'dative' => 'молодшому сержанту КНЯЗЮ Сергію Святославовичу',
                'accusative' => 'молодшого сержанта КНЯЗЯ Сергія Святославовича',
                'instrumental' => 'молодшим сержантом КНЯЗЕМ Сергієм Святославовичем',
                'locative' => 'молодшому сержанту КНЯЗЕВІ Сергієві Святославовичу',
                'vocative' => 'молодший сержанте КНЯЗЮ Сергію Святославовичу',
            ]
        ];

        foreach ($names as $name => $cases) {
            yield "{$name} (nominative)" => [$name, GrammaticalCase::NOMINATIVE, $name];
            foreach ($cases as $case => $expected) {
                yield "{$name} ({$case})" => [$name, GrammaticalCase::from($case), $expected];
            }
        }
    }
} 