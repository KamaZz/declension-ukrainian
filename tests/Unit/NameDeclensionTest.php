<?php

namespace Tests\Unit;

use PHPUnit\Framework\Attributes\DataProvider;
use Tests\TestCase;
use UkrainianDeclension\Enums\GrammaticalCase;
use UkrainianDeclension\Enums\Number;
use UkrainianDeclension\UkrainianDeclension;

class NameDeclensionTest extends TestCase
{
    #[DataProvider('masculineNames')]
    public function testMasculineNames(string $name, GrammaticalCase $case, string $expected): void
    {
        $result = UkrainianDeclension::decline($name, $case, Number::SINGULAR);
        $this->assertEquals($expected, $result);
    }

    public static function masculineNames(): \Generator
    {
        $names = [
            'Пінчук Тарас Аркадійович' => [
                'genitive' => 'Пінчука Тараса Аркадійовича',
                'dative' => 'Пінчуку Тарасу Аркадійовичу',
                'accusative' => 'Пінчука Тараса Аркадійовича',
                'instrumental' => 'Пінчуком Тарасом Аркадійовичем',
                'locative' => 'Пінчукові Тарасові Аркадійовичу',
                'vocative' => 'Пінчуку Тарасе Аркадійовичу',
            ],
            'Тарасенко Богдан Васильович' => [
                'genitive' => 'Тарасенка Богдана Васильовича',
                'dative' => 'Тарасенку Богдану Васильовичу',
                'accusative' => 'Тарасенка Богдана Васильовича',
                'instrumental' => 'Тарасенком Богданом Васильовичем',
                'locative' => 'Тарасенкові Богданові Васильовичу',
                'vocative' => 'Тарасенку Богдане Васильовичу', // Fixed: surname -енко gets -у in vocative (consistent with other -енко surnames)
            ],
            'Руда Максим Казимирович' => [
                'genitive' => 'Руди Максима Казимировича',
                'dative' => 'Руді Максиму Казимировичу',
                'accusative' => 'Руду Максима Казимировича',
                'instrumental' => 'Рудою Максимом Казимировичем',
                'locative' => 'Руді Максимові Казимировичу',
                'vocative' => 'Рудо Максиме Казимировичу',
            ],
            'Горобець Роман Ростиславович' => [
                'genitive' => 'Горобця Романа Ростиславовича',
                'dative' => 'Горобцю Роману Ростиславовичу',
                'accusative' => 'Горобця Романа Ростиславовича',
                'instrumental' => 'Горобцем Романом Ростиславовичем',
                'locative' => 'Горобцеві Романові Ростиславовичу',
                'vocative' => 'Горобцю Романе Ростиславовичу',
            ],
            'Деркач Ярослав Олександрович' => [
                'genitive' => 'Деркача Ярослава Олександровича',
                'dative' => 'Деркачу Ярославу Олександровичу',
                'accusative' => 'Деркача Ярослава Олександровича',
                'instrumental' => 'Деркачем Ярославом Олександровичем',
                'locative' => 'Деркачеві Ярославові Олександровичу',
                'vocative' => 'Деркаче Ярославе Олександровичу',
            ],
            'Пасічник Данило Федорович' => [
                'genitive' => 'Пасічника Данила Федоровича',
                'dative' => 'Пасічнику Данилу Федоровичу',
                'accusative' => 'Пасічника Данила Федоровича',
                'instrumental' => 'Пасічником Данилом Федоровичем',
                'locative' => 'Пасічникові Данилу Федоровичу',
                'vocative' => 'Пасічнику Даниле Федоровичу',
            ],
            'Дубина Матвій Орестович' => [
                'genitive' => 'Дубини Матвія Орестовича',
                'dative' => 'Дубині Матвію Орестовичу',
                'accusative' => 'Дубину Матвія Орестовича',
                'instrumental' => 'Дубиною Матвієм Орестовичем',
                'locative' => 'Дубині Матвієві Орестовичу',
                'vocative' => 'Дубино Матвію Орестовичу',
            ],
            'Тимошенко Дмитро Владиславович' => [
                'genitive' => 'Тимошенка Дмитра Владиславовича',
                'dative' => 'Тимошенку Дмитру Владиславовичу',
                'accusative' => 'Тимошенка Дмитра Владиславовича',
                'instrumental' => 'Тимошенком Дмитром Владиславовичем',
                'locative' => 'Тимошенкові Дмитрові Владиславовичу',
                'vocative' => 'Тимошенку Дмитре Владиславовичу', // Fixed: surname -енко remains unchanged in vocative
            ],
            'Васильченко Олег Пилипович' => [
                'genitive' => 'Васильченка Олега Пилиповича',
                'dative' => 'Васильченку Олегу Пилиповичу', // Fixed: consistent spelling
                'accusative' => 'Васильченка Олега Пилиповича', // Fixed: consistent spelling
                'instrumental' => 'Васильченком Олегом Пилиповичем', // Fixed: consistent spelling
                'locative' => 'Васильченкові Олегу Пилиповичу', // Fixed: surname -енко remains unchanged in vocative
                'vocative' => 'Васильченку Олеге Пилиповичу', // Fixed: surname -енко remains unchanged in vocative
            ],
            'Буряк Артем Вадимович' => [
                'genitive' => 'Буряка Артема Вадимовича',
                'dative' => 'Буряку Артему Вадимовичу',
                'accusative' => 'Буряка Артема Вадимовича',
                'instrumental' => 'Буряком Артемом Вадимовичем',
                'locative' => 'Бурякові Артемові Вадимовичу',
                'vocative' => 'Буряку Артеме Вадимовичу', // Fixed: surname should be declined in vocative
            ],
            'Ломакін Павло Володимирович' => [
                'genitive' => 'Ломакіна Павла Володимировича',
                'dative' => 'Ломакіну Павлу Володимировичу',
                'accusative' => 'Ломакіна Павла Володимировича',
                'instrumental' => 'Ломакіним Павлом Володимировичем',
                'locative' => 'Ломакіні Павлові Володимировичу',
                'vocative' => 'Ломакіне Павле Володимировичу',
            ],
            'Заболотній Василь Сергійович' => [
                'genitive' => 'Заболотнього Василя Сергійовича',
                'dative' => 'Заболотньому Василю Сергійовичу',
                'accusative' => 'Заболотнього Василя Сергійовича',
                'instrumental' => 'Заболотнім Василем Сергійовичем',
                'locative' => 'Заболотньому Василєві Сергійовичу',
                'vocative' => 'Заболотній Василю Сергійовичу',
            ],
            'Коломієць Іван Ярославович' => [
                'genitive' => 'Коломійця Івана Ярославовича',
                'dative' => 'Коломійцю Івану Ярославовичу',
                'accusative' => 'Коломійця Івана Ярославовича',
                'instrumental' => 'Коломійцем Іваном Ярославовичем',
                'locative' => 'Коломійцю Іванові Ярославовичу',
                'vocative' => 'Коломійцю Іване Ярославовичу',
            ],
            'Бербега Олександр Антонович' => [
                'genitive' => 'Бербеги Олександра Антоновича',
                'dative' => 'Бербезі Олександру Антоновичу',
                'accusative' => 'Бербегу Олександра Антоновича',
                'instrumental' => 'Бербегою Олександром Антоновичем',
                'locative' => 'Бербезі Олександрові Антоновичу',
                'vocative' => 'Бербего Олександре Антоновичу',
            ],
            'Ключкей Владислав Іванович' => [
                'genitive' => 'Ключкея Владислава Івановича',
                'dative' => 'Ключкею Владиславу Івановичу',
                'accusative' => 'Ключкея Владислава Івановича',
                'instrumental' => 'Ключкеєм Владиславом Івановичем',
                'locative' => 'Ключкеєві Владиславу Івановичу',
                'vocative' => 'Ключкею Владиславе Івановичу',
            ],
            'Фармуга Степан Васильович' => [
                'genitive' => 'Фармуги Степана Васильовича',
                'dative' => 'Фармузі Степану Васильовичу',
                'accusative' => 'Фармугу Степана Васильовича',
                'instrumental' => 'Фармугою Степаном Васильовичем',
                'locative' => 'Фармузі Степанові Васильовичу',
                'vocative' => 'Фармуго Степане Васильовичу',
            ],
        ];

        foreach ($names as $name => $cases) {
            yield "{$name} (nominative)" => [$name, GrammaticalCase::NOMINATIVE, $name];
            foreach ($cases as $case => $expected) {
                yield "{$name} ({$case})" => [$name, GrammaticalCase::from($case), $expected];
            }
        }
    }

    #[DataProvider('feminineNames')]
    public function testFeminineNames(string $name, GrammaticalCase $case, string $expected): void
    {
        $result = UkrainianDeclension::decline($name, $case, Number::SINGULAR);
        $this->assertEquals($expected, $result);
    }

    public static function feminineNames(): \Generator
    {
        $names = [
            'Яценко Олена Георгіївна' => [
                'genitive' => 'Яценко Олени Георгіївни',
                'dative' => 'Яценко Олені Георгіївні',
                'accusative' => 'Яценко Олену Георгіївну',
                'instrumental' => 'Яценко Оленою Георгіївною',
                'locative' => 'Яценко Олені Георгіївні',
                'vocative' => 'Яценко Олено Георгіївно',
            ],
            'Перепелиця Катерина Орестівна' => [
                'genitive' => 'Перепелиці Катерини Орестівни',
                'dative' => 'Перепелиці Катерині Орестівні',
                'accusative' => 'Перепелицю Катерину Орестівну',
                'instrumental' => 'Перепелицею Катериною Орестівною',
                'locative' => 'Перепелиці Катерині Орестівні',
                'vocative' => 'Перепелице Катерино Орестівно',
            ],
            'Лазаренко Анна Василівна' => [
                'genitive' => 'Лазаренко Анни Василівни',
                'dative' => 'Лазаренко Анні Василівні',
                'accusative' => 'Лазаренко Анну Василівну',
                'instrumental' => 'Лазаренко Анною Василівною',
                'locative' => 'Лазаренко Анні Василівні',
                'vocative' => 'Лазаренко Анно Василівно',
            ],
            'Голуб Марія Генадіївна' => [
                'genitive' => 'Голуб Марії Генадіївни',
                'dative' => 'Голуб Марії Генадіївні',
                'accusative' => 'Голуб Марію Генадіївну',
                'instrumental' => 'Голуб Марією Генадіївною',
                'locative' => 'Голуб Марії Генадіївні',
                'vocative' => 'Голуб Маріє Генадіївно',
            ],
            'Степаненко Софія Данилівна' => [
                'genitive' => 'Степаненко Софії Данилівни',
                'dative' => 'Степаненко Софії Данилівні',
                'accusative' => 'Степаненко Софію Данилівну',
                'instrumental' => 'Степаненко Софією Данилівною',
                'locative' => 'Степаненко Софії Данилівні',
                'vocative' => 'Степаненко Софіє Данилівно',
            ],
            'Даниленко Юлія Олександрівна' => [
                'genitive' => 'Даниленко Юлії Олександрівни',
                'dative' => 'Даниленко Юлії Олександрівні',
                'accusative' => 'Даниленко Юлію Олександрівну',
                'instrumental' => 'Даниленко Юлією Олександрівною',
                'locative' => 'Даниленко Юлії Олександрівні',
                'vocative' => 'Даниленко Юліє Олександрівно',
            ],
            'Шаповалова Вікторія Тимофіївна' => [
                'genitive' => 'Шаповалової Вікторії Тимофіївни',
                'dative' => 'Шаповаловій Вікторії Тимофіївні',
                'accusative' => 'Шаповалову Вікторію Тимофіївну',
                'instrumental' => 'Шаповаловою Вікторією Тимофіївною',
                'locative' => 'Шаповаловій Вікторії Тимофіївні',
                'vocative' => 'Шаповалова Вікторіє Тимофіївно',
            ],
            'Боровик Дарина Едуардівна' => [
                'genitive' => 'Боровик Дарини Едуардівни',
                'dative' => 'Боровик Дарині Едуардівні',
                'accusative' => 'Боровик Дарину Едуардівну',
                'instrumental' => 'Боровик Дариною Едуардівною',
                'locative' => 'Боровик Дарині Едуардівні',
                'vocative' => 'Боровик Дарино Едуардівно',
            ],
            'Присяжнюк Валерія Денисівна' => [
                'genitive' => 'Присяжнюк Валерії Денисівни',
                'dative' => 'Присяжнюк Валерії Денисівні',
                'accusative' => 'Присяжнюк Валерію Денисівну',
                'instrumental' => 'Присяжнюк Валерією Денисівною',
                'locative' => 'Присяжнюк Валерії Денисівні',
                'vocative' => 'Присяжнюк Валеріє Денисівно',
            ],
            'Михайлова Ірина Мирославівна' => [
                'genitive' => 'Михайлової Ірини Мирославівни',
                'dative' => 'Михайловій Ірині Мирославівні',
                'accusative' => 'Михайлову Ірину Мирославівну',
                'instrumental' => 'Михайловою Іриною Мирославівною',
                'locative' => 'Михайловій Ірині Мирославівні',
                'vocative' => 'Михайлова Ірино Мирославівно',
            ],
            'Драпой Наталія Валентинівна' => [
                'genitive' => 'Драпой Наталії Валентинівни',
                'dative' => 'Драпой Наталії Валентинівні',
                'accusative' => 'Драпой Наталію Валентинівну',
                'instrumental' => 'Драпой Наталією Валентинівною',
                'locative' => 'Драпой Наталії Валентинівні',
                'vocative' => 'Драпой Наталіє Валентинівно',
            ],
        ];

        foreach ($names as $name => $cases) {
            yield "{$name} (nominative)" => [$name, GrammaticalCase::NOMINATIVE, $name];
            foreach ($cases as $case => $expected) {
                yield "{$name} ({$case})" => [$name, GrammaticalCase::from($case), $expected];
            }
        }
    }
} 