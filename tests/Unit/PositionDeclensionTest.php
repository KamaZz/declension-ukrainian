<?php

namespace Tests\Unit;

use UkrainianDeclension\Services\AdjectiveDeclensioner;
use UkrainianDeclension\Services\Declensioner;
use UkrainianDeclension\Enums\GrammaticalCase;
use UkrainianDeclension\Enums\Gender;
use UkrainianDeclension\Enums\Number;
use UkrainianDeclension\Services\DeclensionGroupIdentifier;
use UkrainianDeclension\Services\PhraseDeclensioner;
use Tests\TestCase;
use PHPUnit\Framework\Attributes\DataProvider;

class PositionDeclensionTest extends TestCase
{
    #[DataProvider('positionProvider')]
    public function testPositionDeclension(string $phrase, GrammaticalCase $case, string $expected): void
    {
        $nounDeclensioner = new Declensioner(new DeclensionGroupIdentifier());
        $adjectiveDeclensioner = new AdjectiveDeclensioner();
        $phraseDeclensioner = new PhraseDeclensioner($nounDeclensioner, $adjectiveDeclensioner);
        $nounDeclensioner->setPhraseDeclensioner($phraseDeclensioner);

        $result = $nounDeclensioner->decline($phrase, $case, Number::SINGULAR, Gender::MASCULINE);

        $this->assertEquals($expected, $result);
    }

    public static function positionProvider(): array
    {
        $cases = [
            'Оперативний черговий групи бойового управління військової частини А0000' => [
                'nominative' => 'Оперативний черговий групи бойового управління військової частини А0000',
                'genitive' => 'Оперативного чергового групи бойового управління військової частини А0000',
                'dative' => 'Оперативному черговому групи бойового управління військової частини А0000',
                'accusative' => 'Оперативного чергового групи бойового управління військової частини А0000',
                'instrumental' => 'Оперативним черговим групи бойового управління військової частини А0000',
                'locative' => 'Оперативному черговому групи бойового управління військової частини А0000',
                'vocative' => 'Оперативний черговий групи бойового управління військової частини А0000',
            ],
            'Командир ремонтного взводу озброєння ремонтної роти військової частини А0000' => [
                'nominative' => 'Командир ремонтного взводу озброєння ремонтної роти військової частини А0000',
                'genitive' => 'Командира ремонтного взводу озброєння ремонтної роти військової частини А0000',
                'dative' => 'Командиру ремонтного взводу озброєння ремонтної роти військової частини А0000',
                'accusative' => 'Командира ремонтного взводу озброєння ремонтної роти військової частини А0000',
                'instrumental' => 'Командиром ремонтного взводу озброєння ремонтної роти військової частини А0000',
                'locative' => 'Командирові ремонтного взводу озброєння ремонтної роти військової частини А0000',
                'vocative' => 'Командире ремонтного взводу озброєння ремонтної роти військової частини А0000',
            ],
            'Головний сержант 1 зенітного ракетного дивізіону військової частини А0000' => [
                'nominative' => 'Головний сержант 1 зенітного ракетного дивізіону військової частини А0000',
                'genitive' => 'Головного сержанта 1 зенітного ракетного дивізіону військової частини А0000',
                'dative' => 'Головному сержанту 1 зенітного ракетного дивізіону військової частини А0000',
                'accusative' => 'Головного сержанта 1 зенітного ракетного дивізіону військової частини А0000',
                'instrumental' => 'Головним сержантом 1 зенітного ракетного дивізіону військової частини А0000',
                'locative' => 'Головному сержантові 1 зенітного ракетного дивізіону військової частини А0000',
                'vocative' => 'Головний сержанте 1 зенітного ракетного дивізіону військової частини А0000',
            ],
            'Головний сержант батареї перехоплювачів безпілотних літальних апаратів військової частини А0000' => [
                'nominative' => 'Головний сержант батареї перехоплювачів безпілотних літальних апаратів військової частини А0000',
                'genitive' => 'Головного сержанта батареї перехоплювачів безпілотних літальних апаратів військової частини А0000',
                'dative' => 'Головному сержанту батареї перехоплювачів безпілотних літальних апаратів військової частини А0000',
                'accusative' => 'Головного сержанта батареї перехоплювачів безпілотних літальних апаратів військової частини А0000',
                'instrumental' => 'Головним сержантом батареї перехоплювачів безпілотних літальних апаратів військової частини А0000',
                'locative' => 'Головному сержантові батареї перехоплювачів безпілотних літальних апаратів військової частини А0000',
                'vocative' => 'Головний сержанте батареї перехоплювачів безпілотних літальних апаратів військової частини А0000',
            ],
            'Фельдшер сортувально-евакуаційного відділення медичної роти військової частини А0000' => [
                'nominative' => 'Фельдшер сортувально-евакуаційного відділення медичної роти військової частини А0000',
                'genitive' => 'Фельдшера сортувально-евакуаційного відділення медичної роти військової частини А0000',
                'dative' => 'Фельдшеру сортувально-евакуаційного відділення медичної роти військової частини А0000',
                'accusative' => 'Фельдшера сортувально-евакуаційного відділення медичної роти військової частини А0000',
                'instrumental' => 'Фельдшером сортувально-евакуаційного відділення медичної роти військової частини А0000',
                'locative' => 'Фельдшерові сортувально-евакуаційного відділення медичної роти військової частини А0000',
                'vocative' => 'Фельдшере сортувально-евакуаційного відділення медичної роти військової частини А0000',
            ],
            'Старший оператор радіолокаційної станції взводу управління групи бойового управління військової частини А0000' => [
                'nominative' => 'Старший оператор радіолокаційної станції взводу управління групи бойового управління військової частини А0000',
                'genitive' => 'Старшого оператора радіолокаційної станції взводу управління групи бойового управління військової частини А0000',
                'dative' => 'Старшому оператору радіолокаційної станції взводу управління групи бойового управління військової частини А0000',
                'accusative' => 'Старшого оператора радіолокаційної станції взводу управління групи бойового управління військової частини А0000',
                'instrumental' => 'Старшим оператором радіолокаційної станції взводу управління групи бойового управління військової частини А0000',
                'locative' => 'Старшому операторові радіолокаційної станції взводу управління групи бойового управління військової частини А0000',
                'vocative' => 'Старший операторе радіолокаційної станції взводу управління групи бойового управління військової частини А0000',
            ],
            'Кухар господарчого відділення взводу забезпечення 1 зенітного ракетного дивізіону військової частини А0000' => [
                'nominative' => 'Кухар господарчого відділення взводу забезпечення 1 зенітного ракетного дивізіону військової частини А0000',
                'genitive' => 'Кухаря господарчого відділення взводу забезпечення 1 зенітного ракетного дивізіону військової частини А0000',
                'dative' => 'Кухарю господарчого відділення взводу забезпечення 1 зенітного ракетного дивізіону військової частини А0000',
                'accusative' => 'Кухаря господарчого відділення взводу забезпечення 1 зенітного ракетного дивізіону військової частини А0000',
                'instrumental' => 'Кухарем господарчого відділення взводу забезпечення 1 зенітного ракетного дивізіону військової частини А0000',
                'locative' => 'Кухареві господарчого відділення взводу забезпечення 1 зенітного ракетного дивізіону військової частини А0000',
                'vocative' => 'Кухарю господарчого відділення взводу забезпечення 1 зенітного ракетного дивізіону військової частини А0000',
            ],
        ];

        $tests = [];
        foreach ($cases as $word => $declensions) {
            foreach ($declensions as $caseName => $expected) {
                $case = \UkrainianDeclension\Enums\GrammaticalCase::from($caseName);
                $tests[sprintf('%s in %s case', $word, $case->value)] = [$word, $case, $expected];
            }
        }

        return $tests;
    }
}